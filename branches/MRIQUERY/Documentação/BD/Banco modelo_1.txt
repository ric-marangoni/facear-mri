CREATE DATABASE projeto_integrador_mriquery;
use projeto_integrador_mriquery;

CREATE TABLE tb_perfil(
	id_perfil int not null auto_increment,
	perfil char(20)	not null,
	primary key(id_perfil)
);

CREATE TABLE tb_funcionario(
	id_funcionario int not null auto_increment,
	data_admissao datetime not null,
	data_demissao datetime,
	id_perfil int not null,
	primary key(id_funcionario),
	foreign key(id_perfil) references tb_perfil(id_perfil)
);


CREATE TABLE tb_endereco(
	id_endereco int not null auto_increment,
	estado varchar(50),
	cep long,
	cidade varchar(50),
	logradouro varchar(50),
	numero long,
	complemento varchar(50),
	primary key(id_endereco)
);

CREATE TABLE tb_editora(
	id_editora int not null auto_increment,
	editora varchar(100),
	primary key(id_editora)
);

CREATE TABLE tb_usuario(
	id_usuario int not null auto_increment,
	nome varchar(100) not null,
	data_nascimento datetime not null,
	login varchar(50) not null,
	senha varchar(50) not null,
	id_endereco int not null,
	id_endereco_alternativo int not null,
	email_pessoal varchar(100),
	email_comercial varchar(100),
	telefone_celular long,
	telefone_residencial long,
	telefone_comercial long,
	data_cadastro datetime,
	sexo char(1) not null,
	cpf_cnpj long,
	status int,
	primary key(id_usuario),
	foreign key(id_endereco) references tb_endereco(id_endereco),
	foreign key(id_endereco_alternativo) references tb_endereco(id_endereco)
);

CREATE TABLE tb_forma_pagamento(
	id_forma_pagamento int not null auto_increment,
	numero_cartao long,
	bandeira varchar(50),
	data_validade datetime,
	tipo_pagamento int,
	primary key(id_forma_pagamento)
);

CREATE TABLE tb_categoria(
	id_categoria int not null auto_increment,
	categoria varchar(50),
	primary key(id_categoria)
);

CREATE TABLE tb_plano(
	id_plano int not null auto_increment,
	plano varchar(100),
	descricao varchar(200),
	preco double,
	primary key(id_plano)
);

CREATE TABLE tb_assinatura(
	id_assinatura int not null auto_increment,
	id_usuario int not null,
	id_plano int,
	tipo_assinatura int,
	data_inicial datetime,
	data_final datetime,
	id_forma_pagamento int,
	primary key(id_assinatura),
	foreign key(id_usuario) references tb_usuario(id_usuario),
	foreign key(id_plano) references tb_plano(id_plano),
	foreign key(id_forma_pagamento) references tb_forma_pagamento(id_forma_pagamento)	
);

CREATE TABLE tb_produto(
	id_produto int not null auto_increment,
	produto varchar(100),
	tipo_produto int,
	preco double,
	edicao varchar(50),
	id_categoria int not null,
	tipo_publicacao int,
	ano datetime,
	imagem blob,
	id_editora int not null,
	primary key(id_produto),
	foreign key(id_categoria) references tb_categoria(id_categoria),
	foreign key(id_editora) references tb_editora(id_editora)
);

CREATE TABLE tb_plano_produto(
	id_plano_produto int not null auto_increment,
	id_plano int not null,
	id_produto int not null,
	primary key(id_plano_produto),
	foreign key(id_plano) references tb_plano(id_plano),
	foreign key(id_produto) references tb_produto(id_produto)
);